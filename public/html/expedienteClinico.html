<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expediente Clínico - NOM-004-SSA3-2012</title>
  <link rel="stylesheet" href="../css/stylesMedico.css" />
  <link rel="stylesheet" href="../css/stylesExpediente.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inknut+Antiqua:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="../js/expedienteClinico.js" defer></script>
</head>
<body>
  <header>
    <h1>
      <span class="djfa">DJFA</span> 
      <span class="systems">System's</span>
    </h1>
    <div class="profile-icon">
      <i class="fas fa-user-circle"></i>
    </div>
  </header>

  <div class="expediente-container">
    <div class="expediente-paper" id="expedientePaper">
      <!-- HEADER -->
      <div class="expediente-header">
        <div class="expediente-logo">DJFA</div>
        <div class="expediente-title">EXPEDIENTE CLÍNICO</div>
        <div class="expediente-number">
          <span>No. Expediente:</span>
          <strong id="numExpediente">EC-2025-001</strong>
        </div>
      </div>

      <!-- DATOS DEL ESTABLECIMIENTO (NOM 5.2) -->
      <div class="establecimiento-info">
        <p><strong>Establecimiento:</strong> Clínica DJFA System's</p>
        <p><strong>Dirección:</strong> Avenida Siempre Viva #117, Col. Centro, Tuxtla Gutiérrez, Chiapas</p>
        <p><strong>Teléfono:</strong> 961-117-1231 | <strong>Fecha de Apertura:</strong> <span id="fechaApertura"></span> | <strong>Hora:</strong> <span id="horaApertura"></span></p>
      </div>

      <div class="expediente-content">
        <!-- 1. DATOS GENERALES DEL PACIENTE (NOM 5.2.3) -->
        <section class="expediente-section">
          <h3 class="section-header">1. DATOS GENERALES DEL PACIENTE (NOM 5.2.3)</h3>
          <div class="data-grid-3">
            <div class="data-field">
              <label>Nombre Completo:*</label>
              <input type="text" id="nombrePaciente" required>
            </div>
            <div class="data-field">
              <label>Fecha de Nacimiento:*</label>
              <input type="date" id="fechaNacimiento" required>
            </div>
            <div class="data-field">
              <label>Edad:*</label>
              <input type="text" id="edadPaciente" readonly>
            </div>
          </div>
          
          <div class="data-grid-4">
            <div class="data-field">
              <label>Sexo:*</label>
              <select id="sexoPaciente" required>
                <option value="">Seleccionar</option>
                <option value="Masculino">Masculino</option>
                <option value="Femenino">Femenino</option>
              </select>
            </div>
            <div class="data-field">
              <label>Estado Civil:</label>
              <select id="estadoCivil">
                <option value="">Seleccionar</option>
                <option value="Soltero(a)">Soltero(a)</option>
                <option value="Casado(a)">Casado(a)</option>
                <option value="Unión Libre">Unión Libre</option>
                <option value="Divorciado(a)">Divorciado(a)</option>
                <option value="Viudo(a)">Viudo(a)</option>
              </select>
            </div>
            <div class="data-field">
              <label>Ocupación:</label>
              <input type="text" id="ocupacion">
            </div>
            <div class="data-field">
              <label>Grupo Étnico (NOM 6.1.1):</label>
              <input type="text" id="grupoEtnico" placeholder="Si aplica">
            </div>
          </div>

          <div class="data-grid-2">
            <div class="data-field">
              <label>Domicilio Completo:*</label>
              <input type="text" id="domicilio" required>
            </div>
            <div class="data-field">
              <label>Localidad/Municipio:</label>
              <input type="text" id="localidad">
            </div>
          </div>

          <div class="data-grid-3">
            <div class="data-field">
              <label>Teléfono:*</label>
              <input type="tel" id="telefono" required>
            </div>
            <div class="data-field">
              <label>Correo Electrónico:</label>
              <input type="email" id="correo">
            </div>
            <div class="data-field">
              <label>Teléfono de Emergencia:*</label>
              <input type="tel" id="telEmergencia" required>
            </div>
          </div>
        </section>

        <!-- 2. HISTORIA CLÍNICA (NOM 6.1) -->
        <section class="expediente-section">
          <h3 class="section-header">2. HISTORIA CLÍNICA COMPLETA (NOM 6.1)</h3>
          
          <!-- 2.1 ANTECEDENTES HEREDO-FAMILIARES (NOM 6.1.1) -->
          <div class="subsection-header">2.1 Antecedentes Heredo-Familiares (NOM 6.1.1)</div>
          <div class="nota-importante">
            <strong>Incluir:</strong> Diabetes Mellitus, Hipertensión Arterial, Cardiopatías, Cáncer, Enfermedades mentales, Alergias, etc. Especificar parentesco.
          </div>
          <textarea class="textarea-field" id="antecedentesHF" rows="4" placeholder="Ejemplo: Madre con Diabetes Mellitus tipo 2 desde hace 10 años, Padre con Hipertensión Arterial..."></textarea>

          <!-- 2.2 ANTECEDENTES PERSONALES NO PATOLÓGICOS (NOM 6.1.1) -->
          <div class="subsection-header">2.2 Antecedentes Personales No Patológicos (NOM 6.1.1)</div>
          <div class="data-grid-4">
            <div class="data-field">
              <label>Tipo Sanguíneo:</label>
              <select id="tipoSangre">
                <option value="">Seleccionar</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
              </select>
            </div>
            <div class="data-field">
              <label>Tabaquismo (NOM 3.12):*</label>
              <select id="tabaquismo" required>
                <option value="No">No</option>
                <option value="Sí">Sí</option>
                <option value="Ex-fumador">Ex-fumador</option>
              </select>
            </div>
            <div class="data-field">
              <label>Si fuma, cigarros/día:</label>
              <input type="number" id="cigarrosDia" min="0">
            </div>
            <div class="data-field">
              <label>Años fumando:</label>
              <input type="number" id="anosFumando" min="0">
            </div>
          </div>

          <div class="data-grid-3">
            <div class="data-field">
              <label>Alcoholismo (NOM 3.12):*</label>
              <select id="alcoholismo" required>
                <option value="No">No</option>
                <option value="Ocasional">Ocasional</option>
                <option value="Frecuente">Frecuente</option>
                <option value="Crónico">Crónico</option>
              </select>
            </div>
            <div class="data-field">
              <label>Otras sustancias (NOM 3.12):</label>
              <select id="sustancias">
                <option value="No">No</option>
                <option value="Sí">Sí</option>
              </select>
            </div>
            <div class="data-field">
              <label>Especificar sustancia:</label>
              <input type="text" id="especificarSustancia">
            </div>
          </div>

          <textarea class="textarea-field" id="habitosGenerales" rows="3" placeholder="Actividad física, alimentación, higiene personal, vivienda (servicios básicos, hacinamiento), mascotas, etc."></textarea>

          <!-- 2.3 ANTECEDENTES PERSONALES PATOLÓGICOS (NOM 6.1.1) -->
          <div class="subsection-header">2.3 Antecedentes Personales Patológicos (NOM 6.1.1)</div>
          <div class="data-grid-2">
            <div class="data-field">
              <label>Alergias:*</label>
              <input type="text" id="alergias" placeholder="Medicamentos, alimentos, otros">
            </div>
            <div class="data-field">
              <label>Cirugías Previas:</label>
              <input type="text" id="cirugias" placeholder="Tipo de cirugía y año">
            </div>
          </div>

          <div class="checkbox-group">
            <div class="checkbox-item">
              <input type="checkbox" id="diabetesCheck">
              <label for="diabetesCheck">Diabetes Mellitus</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="hipertensionCheck">
              <label for="hipertensionCheck">Hipertensión Arterial</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="asmaCheck">
              <label for="asmaCheck">Asma</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="epilepsiaCheck">
              <label for="epilepsiaCheck">Epilepsia</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="cancerCheck">
              <label for="cancerCheck">Cáncer</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="tuberculosisCheck">
              <label for="tuberculosisCheck">Tuberculosis</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="vihCheck">
              <label for="vihCheck">VIH/SIDA</label>
            </div>
          </div>

          <textarea class="textarea-field" id="enfermedadesCronicas" rows="3" placeholder="Detallar enfermedades crónicas, hospitalizaciones previas, transfusiones sanguíneas, traumatismos, etc."></textarea>

          <!-- 2.4 INTERROGATORIO POR APARATOS Y SISTEMAS (NOM 6.1.1) -->
          <div class="subsection-header">2.4 Interrogatorio por Aparatos y Sistemas (NOM 6.1.1)</div>
          <textarea class="textarea-field" id="interrogatorioSistemas" rows="5" placeholder="Cardiovascular: ___________
Respiratorio: ___________
Digestivo: ___________
Genitourinario: ___________
Endocrino: ___________
Nervioso: ___________
Musculoesquelético: ___________
Piel y anexos: ___________"></textarea>
        </section>

        <!-- 3. PADECIMIENTO ACTUAL (NOM 6.1.1) -->
        <section class="expediente-section">
          <h3 class="section-header">3. PADECIMIENTO ACTUAL (NOM 6.1.1)</h3>
          <div class="data-grid-3">
            <div class="data-field">
              <label>Fecha de Consulta:*</label>
              <input type="date" id="fechaConsulta" required>
            </div>
            <div class="data-field">
              <label>Hora de Consulta:*</label>
              <input type="time" id="horaConsulta" required>
            </div>
            <div class="data-field">
              <label>Tipo de Consulta:</label>
              <select id="tipoConsulta">
                <option value="Primera vez">Primera vez</option>
                <option value="Subsecuente">Subsecuente</option>
                <option value="Urgencia">Urgencia</option>
              </select>
            </div>
          </div>

          <div class="nota-importante">
            <strong>Incluir:</strong> Motivo de consulta, inicio del padecimiento, evolución, síntomas actuales, tratamientos previos convencionales, alternativos y tradicionales (NOM 6.1.1).
          </div>
          <textarea class="textarea-field" id="padecimientoActual" rows="6" placeholder="Descripción cronológica del padecimiento actual..."></textarea>
        </section>

        <!-- 4. EXPLORACIÓN FÍSICA (NOM 6.1.2) -->
        <section class="expediente-section">
          <h3 class="section-header">4. EXPLORACIÓN FÍSICA (NOM 6.1.2)</h3>
          
          <div class="subsection-header">4.1 Signos Vitales (Obligatorios NOM 6.1.2)</div>
          <div class="data-grid-5">
            <div class="data-field">
              <label>Peso (kg):*</label>
              <input type="number" id="peso" step="0.1" required>
            </div>
            <div class="data-field">
              <label>Talla (cm):*</label>
              <input type="number" id="talla" step="0.1" required>
            </div>
            <div class="data-field">
              <label>IMC (kg/m²):*</label>
              <input type="text" id="imc" readonly>
            </div>
            <div class="data-field">
              <label>Temperatura (°C):*</label>
              <input type="number" id="temperatura" step="0.1" required>
            </div>
            <div class="data-field">
              <label>T.A. (mmHg):*</label>
              <input type="text" id="presion" placeholder="120/80" required>
            </div>
          </div>

          <div class="data-grid-4">
            <div class="data-field">
              <label>F.C. (lpm):*</label>
              <input type="number" id="frecuenciaCardiaca" required>
            </div>
            <div class="data-field">
              <label>F.R. (rpm):*</label>
              <input type="number" id="frecuenciaRespiratoria" required>
            </div>
            <div class="data-field">
              <label>SpO2 (%):</label>
              <input type="number" id="saturacion" min="0" max="100">
            </div>
            <div class="data-field">
              <label>Glucosa (mg/dL):</label>
              <input type="number" id="glucosa">
            </div>
          </div>

          <div class="subsection-header">4.2 Habitus Exterior y Exploración Física Completa (NOM 6.1.2)</div>
          <div class="nota-importante">
            <strong>Obligatorio incluir:</strong> Habitus exterior, datos de cabeza, cuello, tórax, abdomen, miembros y genitales (NOM 6.1.2).
          </div>
          <textarea class="textarea-field" id="habitusExterior" rows="2" placeholder="Habitus exterior: Edad aparente, estado nutricional, estado de conciencia, facies, marcha, postura..."></textarea>
          <textarea class="textarea-field" id="exploracionCabeza" rows="2" placeholder="Cabeza y cuello: Cráneo, ojos, oídos, nariz, boca, faringe, cuello, tiroides, ganglios..."></textarea>
          <textarea class="textarea-field" id="exploracionTorax" rows="2" placeholder="Tórax: Inspección, palpación, percusión, auscultación. Campos pulmonares, ruidos cardíacos..."></textarea>
          <textarea class="textarea-field" id="exploracionAbdomen" rows="2" placeholder="Abdomen: Inspección, auscultación, palpación, percusión. Dolor, masas, visceromegalias..."></textarea>
          <textarea class="textarea-field" id="exploracionMiembros" rows="2" placeholder="Extremidades: Movilidad, fuerza, tono, reflejos, edema, pulsos, llenado capilar..."></textarea>
          <textarea class="textarea-field" id="exploracionGenitales" rows="2" placeholder="Genitales (cuando aplique): Inspección externa..."></textarea>
          <textarea class="textarea-field" id="neurologico" rows="2" placeholder="Neurológico: Estado mental, pares craneales, sensibilidad, reflejos..."></textarea>
        </section>

        <!-- 5. RESULTADOS DE ESTUDIOS (NOM 6.1.3) -->
        <section class="expediente-section">
          <h3 class="section-header">5. RESULTADOS PREVIOS Y ACTUALES DE ESTUDIOS (NOM 6.1.3)</h3>
          <textarea class="textarea-field" id="resultadosEstudios" rows="4" placeholder="Laboratorio: Biometría hemática, Química sanguínea, Perfil de lípidos, Examen general de orina, etc.
Gabinete: Radiografías, Ultrasonido, TAC, Resonancia Magnética, Electrocardiograma, etc.
Otros: Resultados de estudios previos relevantes..."></textarea>
        </section>

        <!-- 6. DIAGNÓSTICO(S) O PROBLEMAS CLÍNICOS (NOM 6.1.4) -->
        <section class="expediente-section">
          <h3 class="section-header">6. DIAGNÓSTICO(S) O PROBLEMAS CLÍNICOS (NOM 6.1.4)</h3>
          <div class="nota-importante">
            <strong>Incluir:</strong> Diagnóstico principal y diagnósticos secundarios. Usar nomenclatura CIE-10 cuando sea posible.
          </div>
          <div class="data-field">
            <label>Diagnóstico Principal:*</label>
            <input type="text" id="diagnosticoPrincipal" required>
          </div>
          <div class="data-field" style="margin-top: 10px;">
            <label>Diagnósticos Secundarios:</label>
            <textarea class="textarea-field" id="diagnosticosSecundarios" rows="2" placeholder="Listar diagnósticos adicionales o comorbilidades..."></textarea>
          </div>
        </section>

        <!-- 7. PRONÓSTICO (NOM 6.1.5) -->
        <section class="expediente-section">
          <h3 class="section-header">7. PRONÓSTICO (NOM 6.1.5)</h3>
          <div class="data-grid-2">
            <div class="data-field">
              <label>Pronóstico:*</label>
              <select id="pronostico" required>
                <option value="">Seleccionar</option>
                <option value="Bueno">Bueno</option>
                <option value="Favorable">Favorable</option>
                <option value="Reservado">Reservado</option>
                <option value="Reservado a evolución">Reservado a evolución</option>
                <option value="Grave">Grave</option>
                <option value="Malo">Malo</option>
              </select>
            </div>
            <div class="data-field">
              <label>Observaciones del pronóstico:</label>
              <input type="text" id="observacionesPronostico" placeholder="Detalles adicionales">
            </div>
          </div>
        </section>

        <!-- 8. PLAN DE ESTUDIOS -->
        <section class="expediente-section">
          <h3 class="section-header">8. PLAN DE ESTUDIOS Y LABORATORIOS SOLICITADOS</h3>
          <textarea class="textarea-field" id="planEstudios" rows="4" placeholder="Estudios de laboratorio y gabinete solicitados para confirmar diagnóstico o seguimiento..."></textarea>
        </section>

        <!-- 9. INDICACIÓN TERAPÉUTICA (NOM 6.1.6) -->
        <section class="expediente-section">
          <h3 class="section-header">9. INDICACIÓN TERAPÉUTICA (NOM 6.1.6 y 6.2.6)</h3>
          <div class="nota-importante">
            <strong>OBLIGATORIO:</strong> Especificar dosis, vía de administración y periodicidad para CADA medicamento (NOM 6.2.6).
          </div>
          
          <table class="tabla-medicamentos">
            <thead>
              <tr>
                <th>Medicamento</th>
                <th>Presentación</th>
                <th>Dosis</th>
                <th>Vía</th>
                <th>Frecuencia</th>
                <th>Duración</th>
              </tr>
            </thead>
            <tbody id="tablaMedicamentos">
              <tr>
                <td><input type="text" placeholder="Nombre genérico"></td>
                <td><input type="text" placeholder="mg/ml/tab"></td>
                <td><input type="text" placeholder="Cantidad"></td>
                <td>
                  <select style="width: 100%; padding: 5px;">
                    <option value="Oral">Oral</option>
                    <option value="IV">IV</option>
                    <option value="IM">IM</option>
                    <option value="SC">SC</option>
                    <option value="Tópica">Tópica</option>
                    <option value="Inhalatoria">Inhalatoria</option>
                    <option value="Rectal">Rectal</option>
                    <option value="Oftálmica">Oftálmica</option>
                  </select>
                </td>
                <td><input type="text" placeholder="c/8h, c/12h"></td>
                <td><input type="text" placeholder="7 días"></td>
              </tr>
            </tbody>
          </table>
          <button onclick="agregarFilaMedicamento()" style="padding: 8px 15px; background-color: #0F3759; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;">+ Agregar Medicamento</button>

          <div style="margin-top: 15px;">
            <label style="font-size: 12px; font-weight: 600; color: #0F3759; display: block; margin-bottom: 5px;">Indicaciones Generales y Recomendaciones:</label>
            <textarea class="textarea-field" id="indicacionesGenerales" rows="4" placeholder="Medidas higiénico-dietéticas, reposo, signos de alarma, cuidados específicos, próxima cita de seguimiento..."></textarea>
          </div>
        </section>

        <!-- 10. NOTA DE INTERCONSULTA (Si aplica - NOM 6.3) -->
        <section class="expediente-section">
          <h3 class="section-header">10. INTERCONSULTA (Si aplica - NOM 6.3)</h3>
          <div class="data-grid-2">
            <div class="data-field">
              <label>¿Se solicita interconsulta?</label>
              <select id="solicitaInterconsulta" onchange="toggleInterconsulta()">
                <option value="No">No</option>
                <option value="Sí">Sí</option>
              </select>
            </div>
            <div class="data-field">
              <label>Especialidad solicitada:</label>
              <input type="text" id="especialidadInterconsulta" disabled>
            </div>
          </div>
          <textarea class="textarea-field" id="motivoInterconsulta" rows="3" placeholder="Motivo de la interconsulta y criterios diagnósticos..." disabled></textarea>
        </section>

        <!-- 11. REFERENCIA/TRASLADO (Si aplica - NOM 6.4) -->
        <section class="expediente-section">
          <h3 class="section-header">11. REFERENCIA/TRASLADO (Si aplica - NOM 6.4)</h3>
          <div class="data-grid-2">
            <div class="data-field">
              <label>¿Se refiere al paciente?</label>
              <select id="solicitaReferencia" onchange="toggleReferencia()">
                <option value="No">No</option>
                <option value="Sí">Sí</option>
              </select>
            </div>
            <div class="data-field">
              <label>Establecimiento receptor:</label>
              <input type="text" id="establecimientoReceptor" disabled>
            </div>
          </div>
          <div class="data-grid-2">
            <div class="data-field">
              <label>Motivo de envío (NOM 6.4.3.1):</label>
              <input type="text" id="motivoEnvio" disabled>
            </div>
            <div class="data-field">
              <label>Terapéutica empleada (NOM 6.4.3.3):</label>
              <input type="text" id="terapeuticaEmpleada" disabled>
            </div>
          </div>
        </section>

        <!-- 12. OBSERVACIONES ADICIONALES -->
        <section class="expediente-section">
          <h3 class="section-header">12. OBSERVACIONES Y NOTAS ADICIONALES</h3>
          <textarea class="textarea-field" id="observacionesAdicionales" rows="4" placeholder="Cualquier información adicional relevante para el expediente..."></textarea>
        </section>

        <!-- 13. CONSENTIMIENTO INFORMADO (NOM 10.1) -->
        <section class="expediente-section">
          <h3 class="section-header">13. CONSENTIMIENTO INFORMADO (NOM 10.1)</h3>
          <div class="nota-importante">
            <strong>Nota:</strong> Según NOM 10.1.2, se requiere consentimiento informado para: Ingreso hospitalario, cirugía mayor, anestesia general/regional, salpingoclasia, vasectomía, donación de órganos, investigación clínica, necropsia, procedimientos de alto riesgo, y cualquier procedimiento que entrañe mutilación.
          </div>
          <div class="data-field">
            <label>¿Se requiere consentimiento informado?</label>
            <select id="requiereConsentimiento">
              <option value="No">No</option>
              <option value="Sí">Sí</option>
            </select>
          </div>
          <div class="data-field" style="margin-top: 10px;">
            <label>Tipo de procedimiento:</label>
            <input type="text" id="tipoProcedimiento" placeholder="Especificar si aplica">
          </div>
        </section>

        <!-- FIRMAS (NOM 5.10 y 6.1) -->
        <section class="expediente-section">
          <div class="firma-section">
            <div class="firma-box">
              <div class="firma-line"></div>
              <p class="firma-label">NOMBRE COMPLETO Y FIRMA DEL MÉDICO</p>
              <p class="firma-sublabel">Cédula Profesional: _________________</p>
              <p class="firma-sublabel">Fecha: <span id="fechaFirma"></span> Hora: <span id="horaFirma"></span></p>
            </div>
            <div class="firma-box">
              <div class="firma-line"></div>
              <p class="firma-label">NOMBRE Y FIRMA DEL PACIENTE</p>
              <p class="firma-sublabel">(o representante legal)</p>
              <p class="firma-sublabel">Fecha: <span id="fechaFirmaPaciente"></span></p>
            </div>
          </div>
        </section>
      </div>

      <!-- FOOTER -->
      <div class="expediente-footer">
        <div class="footer-info">
          <p><strong>Clínica DJFA System's</strong> | Avenida Siempre Viva #117, Tuxtla Gutiérrez, Chiapas</p>
          <p><strong>Tel:</strong> 961-117-1231 | <strong>Fecha de Impresión:</strong> <span id="fechaImpresion"></span></p>
          <p style="font-size: 9px; margin-top: 5px;"><strong>NOM-004-SSA3-2012:</strong> Del expediente clínico. Conservación mínima: 5 años (NOM 5.4)</p>
        </div>
      </div>
    </div>

    <!-- BOTONES DE ACCIÓN -->
    <div class="action-buttons">
      <button class="btn-action btn-download" onclick="generarPDFExpediente()">
        <i class="fas fa-download"></i> Descargar PDF
      </button>
      <button class="btn-action btn-cancel" onclick="volverPacientes()">
        <i class="fas fa-arrow-left"></i> Volver
      </button>
    </div>
  </div>
</body>
</html>